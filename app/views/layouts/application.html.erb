<!DOCTYPE html>
<html>
  <head>
    <title><%= content_for(:title)+ " | " unless content_for(:title).blank?%>Travel Script</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobile-web-app-capable" content="yes">
    <%= csrf_meta_tags %>
    <%= csp_meta_tag %>

    <%= yield :head %>

    <%# Enable PWA manifest for installable apps (make sure to enable in config/routes.rb too!) %>
    <%#= tag.link rel: "manifest", href: pwa_manifest_path(format: :json) %>

    <link rel="icon" href="/icon.png" type="image/png">
    <link rel="icon" href="/icon.svg" type="image/svg+xml">
    <link rel="apple-touch-icon" href="/icon.png">

    <%# Includes all stylesheet files in app/assets/stylesheets %>
    <%= stylesheet_link_tag :app, "data-turbo-track": "reload" %>
    <%= javascript_importmap_tags %>

    <%# Bootstrap Icons %>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css"
    />

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">


  </head>

  <body>
    <nav class="navbar navbar-expand-md navbar-light fixed-top custom-navbar">
      <div class="container-fluid justify-content-center">
        
        <!-- Brand with Icon -->
        <%= link_to root_path, class: "navbar-brand d-flex align-items-center me-4" do %>
          <%= image_tag("logo/icons8-t-64.png", alt: "Globe Icon", class: "logo-icon") %>
          Travel Script
        <% end %>

        <!-- Toggler for small screens -->
        <button
          class="navbar-toggler"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#navbarCollapse"
          aria-controls="navbarCollapse"
          aria-expanded="false"
          aria-label="Toggle navigation"
        >
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Centered Nav Links -->
        <div class="collapse navbar-collapse justify-content-center" id="navbarCollapse">
          <ul class="navbar-nav mb-2 mb-md-0 gap-4">
            <%= nav_link root_path do %>
              <%= image_tag("icons/icons8-home-94.png", alt: "Home", class: "nav-icon") %>
              <span class="ms-2">Home</span>
            <% end %>

            <%= nav_link about_path do %>
              <%= image_tag("icons/BigM.png", alt: "About", class: "nav-icon") %>
              <span class="ms-2">About</span>
            <% end %>

            <%= nav_link trips_path do %>
              <%= image_tag("icons/icons8-adventure-96.png", alt: "Trips", class: "nav-icon") %>
              <span class="ms-2">Trips</span>
            <% end %>

            <%# <%= nav_link "/another" do %> 
              <%# <%= image_tag("icons/icons8-home-94.png", alt: "Another Link", class: "nav-icon") %> 
              <%# <span class="ms-2">Another Link</span> %>
            <%# <% end %> 
          </ul>
        </div>

        <div class="form-check form-switch">
          <input class="form-check-input" type="checkbox" role="switch" id="switchCheckChecked" checked>
          <label class="form-check-label" for="switchCheckChecked">Dark Mode</label>
        </div>
        
        <!-- Search Form (right side) -->
        <div class="dropdown">
          <button class="btn btn-link dropdown-toggle" type="button" id="searchDropdown" data-bs-toggle="dropdown" aria-expanded="false">
            <i class="fa-solid fa-magnifying-glass"></i> <!-- Font Awesome search icon -->
          </button>
          <ul class="dropdown-menu dropdown-menu-end p-3" aria-labelledby="searchDropdown">
            <form class="d-flex">
              <input class="form-control form-control-lg me-2" style="width: 200px;" type="search" placeholder="Search trips..." aria-label="Search">
              <button class="btn btn-outline-success" type="submit">Search</button>
            </form>
          </ul>
        </div>
      </div>
    </nav>

    <main class="container-fluid">
      <!-- Begin Flash Message Code  -->
      <div id="flash-messages" class="w-75">
        <% flash.each do |name , msg| %>
          <div class="alert alert-<%= name == "notice" ? "success" : "danger" %> alert-dismissible fade show d-flex justify-content-between" role="alert">
            <p><strong><%= msg %></strong></p>
            <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
          </div>
        <% end %>
      </div>
      <!-- End Flash Message Code  -->
      <div>
        <% if @show_title %>
        <div id="title" class="row">
          <div class="col">
            <h1><%= yield(:title) %></h1>
          </div>
        </div>
      <% end %>
      <%= yield %>
      </div>
    </main>

    <%# Dark Mode Toggle Script %>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const toggle = document.getElementById("switchCheckChecked");

        // Load saved mode from localStorage
        if (localStorage.getItem("darkMode") === "true") {
          document.body.classList.add("dark-mode");
          toggle.checked = true;
        }

        // Listen for toggle changes
        toggle.addEventListener("change", () => {
          document.body.classList.toggle("dark-mode");
          localStorage.setItem("darkMode", document.body.classList.contains("dark-mode"));
        });
      });
    </script>

  </body>
</html>
